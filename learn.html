<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>Work by JavaScript - コード集</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/5.0.0/sanitize.min.css" />
        <style>
        body {
            font-family: "游ゴシック", "Yu Gothic", YuGothic, "Hiragino Kaku Gothic ProN", "Hiragino Kaku Gothic Pro", "メイリオ", Meiryo, "ＭＳ ゴシック", sans-serif;
            background: #EFF5FB;
        }
        .header {
            width: 100%;
            max-width: 900px;
            min-width: 800px;
            margin: 0 auto;
        }
        .header > p {
            text-align: center;
        }
        .pageTitle {
            padding: 10px 10px 0;
        }
        .pageTitle h1{
            margin: 0;
            text-align: center;
            background: #333;
            color: #fff;
            border-radius: 50px;
            min-width: 800px;
        }
        .brdText {
            text-align: center;
            position: relative;
            font-weight: bold;
            margin: 60px 0;
        }
        .brdText:before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            width: 20vw;
            height: 1px;
            background: #000;
        }
        .brdText:after {
            content: "";
            position: absolute;
            right: 0;
            top: 50%;
            width: 20vw;
            height: 1px;
            background: #000;
        }
        .box {
            width: 800px;
            background: #fff;
            padding: 1px 10px;
        }
        .itemList {
            
        }
        .item {
            list-style-type: none;
        }
        .item a {
            color: #000;
        }
        .item a:before {
            content: "";
        }
        .item a:hover {
            transition: all .3s;
            color: #999;
        }
        .codeArea h2 {
            //text-align: center;
            width: 850px;
            margin: 0 auto;
            margin-bottom: 0;
            margin-top: 30px;
            line-height: 2rem;
        }
        .codeArea > p {
            text-decoration: underline;
            width: 800px;
            margin: 10px auto 0;
        }
        .codeArea > p.caps {
            text-decoration: none !important;
        }
        pre {
            min-width: 800px;
            background: #333;
            color: #fff;
            margin: 0;
            display: flex;
            white-space: -moz-pre-wrap; /* Mozilla */
            white-space: -pre-wrap;     /* Opera 4-6 */
            white-space: -o-pre-wrap;   /* Opera 7 */
            white-space: pre-wrap;      /* CSS3 */
            word-wrap: break-word;      /* IE 5.5+ */
        }
        code {
            width: 800px;
            display: block;
            margin: 0 auto;
        }
        code span {
            color: greenyellow;
        }
        .box.exe {
            background: #fff;
            border: 1px solid #000;
            margin: 0 auto;
        }
        .box.exe span {
            color: blue
            ;
        }
        .footer {
            text-align: center;
            padding: 5px 0;
            margin-top: 40px;
            border-top: 1px solid #999;
            background: #fff;
        }
        .footer small {
        }
        </style>
    </head>
    <body>
        <div class="header">
            <div class="pageTitle">
                <h1>Work by JavaScript - コード集</h1>
            </div>
            <p><a href="http://www.cl.ecei.tohoku.ac.jp/nlp100/" target="_blank">これ</a>の演習的なもの。DevToolで出力確認。</p>
        </div>

        <div class="codeArea">
            <h2>000. 文字列の逆順</h2>
            <p>コード</p>
            <pre>
                <code>
var answer = 'stressed'.split("").reverse().join("");
console.log(answer);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;desserts
            </div>
        </div>

        <div class="codeArea">
            <h2>001. 「パタトクカシーー」</h2>
            <p>コード</p>
            <pre>
                <code>
var answer = "";
for(var i in o = [0, 2, 4, 6]){
  answer += 'パタトクカシーー'.charAt(o[i]);
}
console.log(answer);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;パトカー
            </div>
        </div>

        <div class="codeArea">
            <h2>002. 「パトカー」＋「タクシー」＝「パタトクカシーー」</h2>
            <p>コード</p>
            <pre>
                <code>
var answer = "";
for (var i = 0; i < "パトカー".length; i++) {
  answer += "パトカー".charAt(i) + "タクシー".charAt(i);
}
console.log(answer);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;パタトクカシーー
            </div>
        </div>

        <div class="codeArea">
            <h2>003. 円周率</h2>
            <p>コード</p>
            <pre>
                <code>
var list = "Now I need a drink, alcoholic of course, after the heavy lectures involving quantum mechanics.".replace(/,|\./g,'').split(" ");
var answer = [];
for(var i = 0; i&lt;list.length; i++ ){
  answer[i] = list[i].length;
}
console.log(answer);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;[3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5, 8, 9, 7, 9]
            </div>
        </div>

        <div class="codeArea">
            <h2>004. 元素記号</h2>
            <p>コード</p>
            <pre>
                <code>
var list = "Hi He Lied Because Boron Could Not Oxidize Fluorine. New Nations Might Also Sign Peace Security Clause. Arthur King Can.".replace(/,|\./g,'').split(" ");
var answer = {};
for(var i = 0; i&lt;list.length; i++ ){
  answer[String(i+1)] = list[i].slice(0,2);
}
for(var i in o = [1, 5, 6, 7, 8, 9, 15, 16, 19]){
  answer[o[i]] = answer[o[i]].charAt(0);
}
console.log(answer);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;{1: "H", 2: "He", 3: "Li", 4: "Be", 5: "B", 6: "C", 7: "N", 8: "O", 9: "F", 10: "Ne", 11: "Na", 12: "Mi", 13: "Al", 14: "Si", 15: "P", 16: "S", 17: "Cl", 18: "Ar", 19: "K", 20: "Ca"}
            </div>
        </div>

        <div class="codeArea">
            <h2>005. n-gram</h2>
            <p>コード</p>
            <pre>
                <code>
var Ngram = function(list,n,separator){
  this.list = list;
  this.n = n;
  this.word = [];
  this.character = [];
  this.separator = separator;
  this.init = function(){
    if(typeof this.list == "string"){
      this.list = this.list.replace(/,|\./g,'').split(" ");
    }
    this.setWord();
    this.setCharacter();
  }
  this.setWord = function(){
    this.word = [];
    this.njoin(this.list,this.word);
  }
  this.setCharacter = function(){
    this.character = [];
    var strings = this.list.join("").split("");
    this.njoin(strings,this.character);
  }
  this.njoin = function(in_list,out_list){
    for(var i = 0; i<= in_list.length - this.n; i++){
      var t = [];
      for (var j=0; j&lt;this.n; j++){
        t.push(in_list[i+j]);
      }
      out_list.push(t.join(this.separator));
    }
  }
  this.init();
}

var answer = new Ngram("I am an NLPer",2,"-");
console.log(answer.word);
console.log(answer.character);
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;["I-am", "am-an", "an-NLPer"]<br>
                &gt;["I-a", "a-m", "m-a", "a-n", "n-N", "N-L", "L-P", "P-e", "e-r"]
            </div>
        </div>

        <div class="codeArea">
            <h2>006. 集合</h2>
            <p>コード</p>
            <pre>
                <code>
わからん…
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>007. テンプレートによる文生成</h2>
            <p>コード</p>
            <pre>
                <code>
var tmplSentence = function (x, y, z) {
  return x+"時の"+y+"は"+z;
}
console.log(tmplSentence(12,"気温",22.4));
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;12時の気温は22.4
            </div>
        </div>

        <div class="codeArea">
            <h2>008. 暗号文</h2>
            <p>コード</p>
            <pre>
                <code>
var Cipher = function(diffcode,pattern){
  this.diffcode = diffcode;
  this.pattern = pattern;
  this.process = function(str){
    var strings = str.split("");
    var encodeStrings = "";
    for (var i = 0; i < strings.length; i++) {
      if(strings[i].match(this.pattern)){
        encodeStrings += String.fromCharCode(this.diffcode - strings[i].charCodeAt(0));
      }else{
        encodeStrings += strings[i];
      }
    }
    return encodeStrings;
  }
}

var cipher = new Cipher(219,/^[a-z]+$/);
console.log(answer = cipher.process("Hi He Lied Because Boron Could Not Oxidize Fluorine. New Nations Might Also Sign Peace Security Clause. Arthur King Can."));
console.log(cipher.process(answer));
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;Hr Hv Lrvw Bvxzfhv Blilm Clfow Nlg Ocrwrav Foflirmv. Nvd Nzgrlmh Mrtsg Aohl Srtm Pvzxv Svxfirgb Cozfhv. Aigsfi Krmt Czm.<br>
                &gt;Hi He Lied Because Boron Could Not Oxidize Fluorine. New Nations Might Also Sign Peace Security Clause. Arthur King Can.
            </div>
        </div>

        <div class="codeArea">
            <h2>009. Typoglycemia</h2>
            <p>コード</p>
            <pre>
                <code>
わからん…
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <p class="brdText">第2章はコマンドライン操作なのでスキップ。</p>

        <div class="codeArea">
            <h2>020. JSONデータの読み込み</h2>
            <p class="caps">対象となるjsonは<a href="jawiki-country.json" target="_blank">これ</a>。</p>
            <p class="caps">下記 main.js 内に各項目ごとにまとめて記述。</p>
            <div class="codeArea">
                <pre>
                    <code>
var MyWikipediaAPI = function(url){
  this.datas = [];
  this.url = url;
  /**
  * ajaxでdata取得
  * @method getData
  * @return jsonデータ
  */
  this.getData = $.ajax({
      url:this.url,
      type:'GET',
      cache:true,
      context:this,
      dataType:'text'
    });
  /**
  * データの整形
  * @method shaping
  * @param {string} t 行分割したテキスト
  */
  this.shaping = function(t){
    //カテゴリ(問21,22)
    t.categoles = t.text.match(/\[\[カテゴリ:[^\]]*?\]\]/g);
    if(t.categoles){
      for (var j = 0; j < t.categoles.length; j++) {
        t.categoles[j] = t.categoles[j].replace(/\[\[カテゴリ:([^\]]*?)\]\]/,'$1');
      }
    }
    //セクション(問23)
    t.sections = t.text.match(/={2,} [^=]*? ={2,}/g);
    if(t.sections){
      for (var j = 0; j < t.sections.length; j++) {
        _level = t.sections[j].replace(/(={2,}).+/,'$1').length - 1
        t.sections[j] = {
          level:_level,
          name:t.sections[j].replace(/^={2,} (.*?) ={2,}$/,'$1')
        }
      }
    }
    //ファイル(問24)
    t.files = t.text.match(/\[\[ファイル:[^\]]*?\]\]/g);
    if(t.files){
      for (var j = 0; j < t.files.length; j++) {
         _datas = t.files[j].replace(/\[\[ファイル:([^\]]*?)\]\]/,'$1').split("|");
         t.files[j] = {
           name:_datas[0],
           size:_datas[1],
           alt:_datas[2]
         }
      }
    }
    //基礎情報(問25~29)
    if(t.text.match(/{{基礎情報[\s\S]*?}}\n/g)){
      //基礎情報スタート位置
      var _lines = t.text.replace(/[\s\S]*{{基礎情報 国([\s\S]*)/g,'$1').replace(/\|\n/g,'\n|').split("\n|");
      var _setLines = []
      for (var j = 0; j < _lines.length; j++) {
        var targetLine = _lines[j];
        //問25
        targetLine = targetLine.trim().replace('|','');
        //基礎情報が終わるポイント
        if(targetLine.indexOf("}}\n") == 0){
          j = _lines.length + 1;
        }else if(targetLine.indexOf("}}\n") > 0){
          targetLine = targetLine.split("}}\n")[0];
          j = _lines.length + 1;
        }
        if(j<_lines.length && targetLine != ""){
          //問26
          targetLine = targetLine.replace(/'{2,}/g,'');
          //問27
          var _reg = /\[\[(.*?)\]\]/g;
          var _rep = "__reg__link__ptn__";
          var _links = targetLine.match(_reg);
          if(_links){
            targetLine = targetLine.replace(_reg,_rep);
            for (var k = 0; k < _links.length; k++) {
              var _cnp = _links[k].replace(_reg,'$1').split("|");
              targetLine = targetLine.replace(_rep,_cnp[_cnp.length - 1]);
            }
          }
          //問28
          targetLine = targetLine
            .replace(/<("[^"]*"|'[^']*'|[^'">])*>/g,'')
            .replace(/{{[^\|]*?\|/g,'')
            .replace(/}}/g,'')
            .replace(/\[[^\[]*?\]/g,'');

          //キー配列に変換
          var _name = targetLine.replace(/([^=]*?)=[\s\S]*/,'$1').trim();
          var _val = targetLine.replace(/.*?=([\s\S]*)/,'$1').trim().replace(/\n/,'');
          _setLines[_name] = _val;
        }
      }
      t.baseData = _setLines;
    }
    this.datas[t.title] = t;
  }
  /**
  * 国旗画像のデータを取得
  * @method getFlagImg
  * @param {string} name 国名
  * @return jsonデータ
  */
  this.getFlagImg = function(name){
    if(this.datas[name].baseData["国旗画像"]){
      return $.ajax({
          url: 'https://en.wikipedia.org/w/api.php?action=query&titles=File:' + encodeURIComponent(this.datas[name].baseData["国旗画像"]) + '&prop=imageinfo&iiprop=url&format=json',
          type:'get',
          context:this,
          dataType:'jsonp'
      });
    }
  }
}
                    </code>
                </pre>
            </div>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>021. カテゴリ名を含む行を抽出</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>022. カテゴリ名の抽出</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>023. セクション構造</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>024. ファイル参照の抽出</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>025. テンプレートの抽出</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>026. 強調マークアップの除去</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>027. 内部リンクの除去</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>028. MediaWikiマークアップの除去</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="codeArea">
            <h2>029. 国旗画像のURLを取得する</h2>
            <p>コード</p>
            <pre>
                <code>
                </code>
            </pre>
            <p>実行（例）</p>
            <div class="box exe">
                &gt;
            </div>
        </div>

        <div class="footer">
            <small>&copy; hoge</small>
        </div>
    </body>
</html>